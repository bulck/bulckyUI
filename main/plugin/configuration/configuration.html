<script>
   $("[title]").tooltip({ 
        position: { my: "left+20 center-30", at: "right+15 center-10" },
        close: function (event, ui) {
            ui.tooltip.hover(
            function () {
                $(this).stop(true).fadeTo(300, 1);
            },    
            function () {
                $(this).fadeOut("300", function () {
                    $(this).remove();
                })
            });
        } 
    });
</script>
<br />
<p class="title_conf"><?php echo __('CONFIGURE_TITLE_CULTIBOX'); ?></p>
<br />
<form action="/bulcky/index.php?menu=configuration" method="post" name="configform" id="configform">
    <table class="table_width">
        <tr>    
            <td class="conf-menu-marge"></td>
            <td class="center_menu">
                <button id="div_user_label" class="cultipi_menu_h1" onclick="expand('user_interface'); return false;"><?php echo __('USER_CONF'); ?></button>
            </td>
            <td>
                <button id="div_card_label" style="display:none" class="menu_h1" onclick="expand('card_interface'); return false;"><?php echo __('CONFIGURE_CARD'); ?></button>
            </td>
             <td class="center_menu">
                <button id="div_network_label" class="cultipi_menu_h1" onclick="expand('network_conf_ui'); return false;"><?php echo __('CULTIPI_NETWORK_CONF'); ?></button>
            </td>
            <td class="center_menu">
                <button id="div_admin_label" class="cultipi_menu_h1" onclick="expand('admin_ui'); return false;"><?php echo __('CULTIPI_ADMIN'); ?></button>
            </td>
            <td class="conf-menu-marge"></td>
        </tr>
    </table>    
    <br />
    <div id="div_alarm_description" style="display:none">
        <br />
        <table class="table_width">
            <tr>
                <td class="conf-menu-marge"></td>
                <td><?php echo __('ALARM_DESCRIPTION'); ?></td>
                <td class="conf-menu-marge"></td>
            </tr>
        </table>
        <br />
    </div>
<hr />
<br />

<div id="div_user_interface" style="display:none">
      <table class="table_width">
        <tr>
            <td class="calendar-conf-marge"></td>
            <td class="icon_menu">
        <a href="" id="export_conf"><img src='/bulcky/main/libs/img/dl_conf.png' alt='' title="<b><?php echo __('EXPORT_CONF'); ?> : </b><?php echo __('TOOLTIP_EXPORT_CONF'); ?>"></a>
            </td>
            <td class="icon_menu">
                <a href="" id="import_conf"><img src='/bulcky/main/libs/img/up_conf.png' alt='' title="<b><?php echo __('IMPORT_CONF_CULTIPI'); ?> : </b><?php echo __('TOOLTIP_IMPORT_CONF'); ?>"></a><input id="confupload" type="file" name="files[]" style="display:none">
            </td>
            <td></td>
        </tr>
    </table>
    <hr class="hr_cultipi" />
    <br />

    <table class="conf-table">
       <tr>
            <td class="conf-marge"></td>
            <td class="conf-marge-td"><?php echo __('CONFIGURE_NB_PLUGS'); ?>:</td>
            <td>
               <select name="nb_plugs" id="nb_plugs">
                    <?php
                        for($i=$GLOBALS['NB_MIN_PLUG'];$i<=$GLOBALS['NB_MAX_PLUG'];$i++) {
                            if(!strcmp ("$i","$nb_plugs")) {
                                echo "<option value=\"${i}\" selected>${i}</option>";
                            } else {
                                echo "<option value=\"${i}\">${i}</option>";
                            }
                        }
                    ?>
            </select>
            </td>
            <td></td>
       </tr>
        <tr>
            <td class="conf-marge"></td>
            <td class="conf-marge-td"><?php echo __('ADVANCED_REGUL_OPTIONS'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_SECOND_REGUL_ENABLE'); ?>" /></td>
            <td>
                <select name="advanced_regul_options" id="advanced_regul_options">
                    <option value="True" <?php if(strcmp("$advanced_regul","True")==0) echo "selected"; ?>><?php echo __('YES'); ?></option>
                    <option value="False" <?php if(strcmp("$advanced_regul","False")==0) echo "selected"; ?>><?php echo __('NO'); ?></option>
                </select>
            </td>
            <td></td>
        </tr>
    </table>
</div>
<!-- End of Interface tab -->

<div id="div_submit_interface" style="display:none">
    <br />
    <hr />
    <input type="hidden" id="submenu" name="submenu" value="<?php echo $submenu; ?>" />
    <br /><p class="p_center">
       <input type="hidden" value="<?php echo __('VALIDATION_CONF'); ?>" id="submit_conf_value" name="submit_conf_value">
       <input type="submit" value="<?php echo __('VALIDATION_CONF'); ?>" id="submit_conf" name="submit_conf">
    </p>
</div>
</form>

<div id="div_card_interface" style="display:none">
    <form action="/bulcky/index.php?menu=configuration" method="post" id="format_sd_form" name="format_sd_form">
        <table class="conf-table">
        <tr>
            <td class="conf-marge"></td>
            <td class="conf-marge-td"><?php echo __('MANAGE_RESET_SD_CARD'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_FORMAT_SD'); ?>" /></td>
            <td >
                <?php 
                    if((isset($hdd_list))&&(count($hdd_list)>0)) { ?>
                        <select name="selected_hdd" id="selected_hdd">
                            <?php  foreach($hdd_list as $hdd) { ?>
                                <option value="<?php echo "$hdd"; ?>"><?php echo "$hdd"; ?></option>
                            <?php } ?>
                        </select>
                <?php  } ?>
                <button id="reset_sd_card_submit" name="reset_sd_card_submit" 
                <?php if((isset($hdd_list))&&(count($hdd_list)>0)) { ?> 
                    class="delete"><?php echo __('MANAGE_RESET_CARD'); ?>
                <?php } else { ?>
                    disabled class="inputDisable"><?php echo __('MANAGE_RESET_CARD_NOT_FOUND'); ?>
                <?php } ?>
                </button>

            </td>
            <td></td>
        </tr>
        </table>
        <div id="format_dialog_sd" title="<?php echo __('CONFIRMATION'); ?>" style="display:none">
        <p><?php echo __('RESET_CONFIRM_SD_CARD'); ?></p>
        </div>
        <br />
        <hr />
    </form>

    <div id="progress" title="<?php echo __('FORMAT_PROGRESS'); ?>" style="display:none">
        <div id="progress_bar"></div>
        <br />
        <p class="p_center">
            <label class="format_success" id="success_format" style="display:none"><?php echo __('SUCCESS_FORMAT'); ?></label>
            <label class="format_error" id="error_format" style="display:none"><?php echo __('ERROR_FORMAT'); ?></label>
        </p>
    </div>
</div>

<div class="format_error" id="locked_sd_card" title="" style="display:none">
    <p><?php echo __('LOCKED_CARD'); ?></p>
</div>


<div class="popup_message" id="update_conf" title="" style="display:none">
    <p><?php echo __('VALID_UPDATE_CONF'); ?></p>
</div>


<div class="popup_error" id="error_update_conf" title="" style="display:none">
    <p><?php echo __('ERROR_UPDATE_CONF'); ?></p>
</div>

<div id="success_import_conf" title="<?php echo __('IMPORT_CONF'); ?>" style="display:none">
    <p><?php echo __('SUCCESS_IMPORT_CONF'); ?></p>
</div>


<div id="error_import_conf" title="<?php echo __('IMPORT_CONF'); ?>" style="display:none">
    <p><?php echo __('ERROR_IMPORT_CONF'); ?></p>
</div>

<div id="import_conf_div" style="display:none">
    <table class="conf-table">
       <tr>
             <td class="conf-marge"></td>
             <td class="conf-marge-td"><?php echo __('IMPORT_CONF_CULTIPI'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_IMPORT_CONF'); ?>" /><label id="import_conf_name" class="imported_file"></label></td>
            <td>
                <input id="confupload" type="file" name="files[]">
                <button name="import" value="<?php echo __('SELECT_FILE_NAME'); ?>" id="import_conf" class="inputDisable" disabled>
                    <?php  echo __('SELECT_FILE_NAME'); ?>
                </button><br />
            </td>
            <td></td>
       </tr>
    </table>
</div>

<div id="preparing-file-modal" title="" style="display: none;"><?php echo __('PREPARING_EXPORT'); ?><img src="main/libs/img/waiting_small.gif" alt="" /></div>


<!-- Conf reseau -->
<div id="div_network_conf_ui" style="display:none">
    <!-- Top button -->
    <table class="table_width">
        <tr>
            <td class="calendar-conf-marge"></td>
            <td class="icon_menu">
                <a href="" id="reset_network_img"><img src='/bulcky/main/libs/img/service_restart.png' alt='' title="<?php echo __('RESET_NETWORK_CONF'); ?>"></a>
            </td>
            <td class="icon_menu">
                <a href="" id="dl-bonjour"><img src='/bulcky/main/libs/img/download-bonjour.png' alt='' title="<?php echo __('CULTIPI_DL_BONJOUR'); ?>"></a>
            </td>
            <td class="icon_menu">
                <a href="" id="mail-config"><img src='/bulcky/main/libs/img/mail_icon.png' alt='' title="<?php echo __('MAIL_CONFIG'); ?>"></a>
            </td>
            <td class="icon_menu">
                <a href="" id="supervision_config"><img src='/bulcky/main/libs/img/supervision.png' id="supervision_config" alt='' title="<?php echo __('CONF_SUPERVISION'); ?>"></a>
            </td>
            <td class="icon_menu">
                <input type="image" src='/bulcky/main/libs/img/lock.png' id="conf_https" alt='' title="<?php echo __('ENABLE_HTTPS'); ?>" style="display:none" />
                <input type="image" src='/bulcky/main/libs/img/unlock.png' id="conf_http" alt='' title="<?php echo __('DISABLE_HTTPS'); ?>" style="display:none" />
            </td>
            <td>
            </td>
        </tr>
    </table>
    <br />
    <hr class="hr_cultipi" />
    <br />
    <br />

    <label class="title_conf"><?php echo __('CONFIGURE_TITLE_CULTIBOX_NET'); ?></label>
    <p class="p_center"><?php echo __('CONFIGURE_SUBTITLE'); ?></p>
    <br /><br />
    <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post" name="configform_network" id="configform_network">

        <!-- Start of wire conf tab -->
        <table class="table_width">
            <tr>
                <td class="conf-marge"></td>
                <td class="conf-title"><label class="subsub_title"><?php echo __('WIRE_CONF'); ?>:</label><img src="main/libs/img/infos.png" alt="" title="<?php if(strcmp("$eth_phy","")==0) { echo __('NO_IFACE_FOUND'); } else { echo __('PHY_ADDR').": ".strtoupper($eth_phy); } ?>" /></td>
                <td></td>
            </tr>
        </table>

        <div id="wire_interface" <?php if((!$wire_enable)||(strcmp("$eth_phy","")==0)) echo 'style="display:none"'; ?>>
            <p class="p_center">
               <input type="radio" name="wire_type" value="dhcp" <?php if($wire_dhcp) echo 'checked'; ?>><?php echo __('DYNAMIC_IP_ADDR'); ?><img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_DYNAMIC_IP'); ?>" />
               <input type="radio" name="wire_type" value="static" <?php if($wire_static) echo 'checked'; ?>><?php echo __('MANUAL_IP_ADDR'); ?><img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_MANUAL_IP'); ?>" />
            </p>

            <div id="wire_static" <?php if(!$wire_static) echo 'style="display:none"'; ?>>
            <table class="table_width">
            <tr>
                <td class="conf-marge-field"></td>
                <td class="conf-field-title"><?php echo __('IP_ADDR'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_IP_ADDR'); ?>" /></td>
                <td class="conf-field-field"><input type="text" size="15" id="wire_address" name="wire_address" maxlength=15 value="<?php echo $wire_address; ?>"></td>
                <td><div id="error_wire_ip" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_WIFI_IP'); ?></div></td>
             </tr>
             <tr>
                <td></td>
                <td><?php echo __('IP_MASK'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_MASK_ADDR'); ?>" /></td>
                <td><input type="text" size=15 maxlength=15 id="wire_mask" name="wire_mask" value="<?php echo $wire_mask; ?>"></td>
                <td><div id="error_wire_mask" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_WIFI_IP_MASK'); ?></div></td>
             </tr>
             <tr>
                <td></td>
                <td><?php echo __('GATEWAY'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_GATEWAY'); ?>" /></td>
                <td><input type="text" size=15 maxlength=15 id="wire_gw" name="wire_gw" value="<?php echo $wire_gw; ?>"></td>
                <td></td>
             </tr>
             </table>
            </div>
        </div>
        <br />
        <hr />
        <br /><br />

        <!-- Start of wirless conf tab -->
        <table class="table_width">
            <tr>
                <td class="conf-marge"></td>
                <td class="conf-title"><label class="subsub_title"><?php echo __('WIRELESS_CONF'); ?>:</label><img src="main/libs/img/infos.png" alt="" title="<?php if(strcmp("$wlan_phy","")==0) { echo __('NO_IFACE_FOUND'); } else { echo __('PHY_ADDR').": ".strtoupper($wlan_phy); } ?>" /></td>
                <td>
            </tr>
        </table>
        <br />
        <div id="wifi_interface" <?php if(!$wifi_enable) { echo 'style="display:none"'; } ?>>
            <table class="table_width">
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td><button id="wifi_scan"><?php echo __('WIFI_SCAN_ESSID'); ?></button></td>
                </tr>
                <tr>
                    <td class="conf-marge-field-wifi"></td>
                    <td class="conf-field-title-wifi"><?php echo __('CONFIGURE_WIFI_SSID'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_WIFI_SSID'); ?>" /></td>
                     <td class="conf-field-field-wifi">
                        <input  type="text" size="15" name="wifi_ssid" id="wifi_ssid" value="<?php echo $wifi_ssid; ?>" />
                    </td>
                        <td><div id="error_wifi_ssid" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_SSID_VALUE'); ?></div></td>
                    </tr>
                   <tr>
                        <td></td>
                        <td><?php echo __('CONFIGURE_WIFI_KEY_TYPE'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_WIFI_KEY_TYPE'); ?>" /></td>
                        <td>
                            <select name="wifi_key_type" id="wifi_key_type">
                                <?php foreach( $GLOBALS['WIFI_KEY_TYPE_LIST'] as $key) { ?>
                                    <option value="<?php echo $key; ?>" <?php if($key == $wifi_key_type) echo 'selected'; ?>><?php echo $key; ?></option>
                                <?php } ?>
                            </select>
                        </td>
                        <td></td>
                   </tr>
                          <tr>
                        <td></td>
                        <td><?php echo __('CONFIGURE_WIFI_PASSWORD'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_PASSWORD'); ?>" /></td>
                        <td>
                            <input  type="password" size="15" 
                                    name="wifi_password" id="wifi_password" value="" <?php if(strcmp("$wifi_key_type","NONE")==0) { echo 'disabled'; } ?> />
                            <img src='/bulcky/main/libs/img/eye.png' alt='' title="<?php echo __('SHOW_CURRENT_PWD'); ?>" id="eyes" <?php if(strcmp("$wifi_key_type","NONE")==0) echo 'style="display:none"';  ?>>
                        </td>
                        <td>
                            <div id="error_wifi_password" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_PASSWORD_VALUE'); ?></div><?php echo __('HEX_PASSWORD'); ?>:<input id="hex_password" type="checkbox" <?php if(strcmp("$wifi_key_type","WEP")!=0) { echo 'disabled'; } ?> />
                            <div id="error_wifi_empty_password" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_EMPTY_PASSWORD'); ?></div>
                            <div id="error_password_wep" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_WEP_KEY_TYPE'); ?></div>
                            <div id="error_password_wep_hexa" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_WEP_KEY_TYPE_HEXA'); ?></div>
                            <div id="error_password_wpa" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_WPA_KEY_TYPE'); ?></div>
                        </td>
                   </tr>
                   <tr>
                        <td></td>
                        <td><?php echo __('CONFIGURE_WIFI_PASSWORD_CONFIRM'); ?>:</td>
                        <td>
                            <input type="password" size="15" 
                                   name="wifi_password_confirm" id="wifi_password_confirm" value="" <?php if(strcmp("$wifi_key_type","NONE")==0) { echo 'disabled'; } ?>/>
                        </td>
                        <td><div id="error_wifi_password_confirm" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_PASSWORD_VALUE'); ?></div></td>
                   </tr>
                   <tr>
                        <td></td>
                        <td><?php echo __('ADDR_TYPE'); ?>:</td>
                        <td>
                            <input type="radio" name="wifi_type" value="dhcp" <?php if(($wifi_dhcp)||(strcmp("$wifi_ssid","")==0)) echo 'checked'; ?>><?php echo __('DYNAMIC_IP_ADDR'); ?><img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_DYNAMIC_IP'); ?>" />
                            <input type="radio" name="wifi_type" value="static" <?php if(($wifi_static)&&(strcmp("$wifi_ssid","")!=0)) echo 'checked'; ?>><?php echo __('MANUAL_IP_ADDR'); ?><img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_MANUAL_IP'); ?>" /><br /></td>
                        <td></td>   
                </table>
            <div id="manual_ip_wifi" <?php if((!$wifi_static)||(strcmp("$wifi_ssid","")==0)) echo "style='display:none'"; ?>>
                <table class="table_width">
                    <tr>
                        <td class="conf-marge-field-wifi"></td>
                        <td class="conf-field-title-wifi"><?php echo __('CONFIGURE_WIFI_IP'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_WIFI_IP'); ?>" /></td>
                        <td class="conf-field-field-wifi"><input type="text" size="15" name="wifi_ip" id="wifi_ip" value="<?php echo $wifi_address; ?>" />
                        <td><div id="error_wifi_ip" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_WIFI_IP'); ?></div></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><?php echo __('CONFIGURE_WIFI_IP_MASK'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_MASK_ADDR'); ?>" /></td>
                        <td><input type="text" size="15" name="wifi_mask" id="wifi_mask" value="<?php echo $wifi_mask; ?>" /></td>
                        <td><div id="error_wifi_mask" style="display:none" class="error_field"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_WIFI_IP_MASK'); ?></div></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><?php echo __('GATEWAY'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_GATEWAY'); ?>" /></td>
                        <td><input type="text" size="15" name="wifi_gw" id="wifi_gw" value="<?php echo $wifi_gw; ?>" /></td>
                        <td></td>
                    </tr>
                </table>
            </div>
        </div>
        <br />
        <hr />
        <br />
        <p class="p_center">
            <input type="submit" id="submit_conf_network" name="submit_conf_network" value="<?php echo __('SAVE_CONF'); ?>">
        </p>
    </form>
</div>

<!-- Admin -->
<div id="div_admin_ui" style="display:none">
    <table class="table_width">
        <tr>
            <td class="calendar-conf-marge"></td>
            <td class="icon_menu2">
                <a href="" id="view_logs"><img src='/bulcky/main/libs/img/view_logs.png' alt='' title="<?php echo __('CULTIPI_VIEW_LOGS'); ?>"></a>
            </td>
            <td class="icon_menu2">
                <a href="" id="dl_logs"><img src='/bulcky/main/libs/img/dl_logs.png' alt='' title="<?php echo __('CULTIPI_DL_LOGS'); ?>"></a>
            </td>
            <td class="icon_menu2">
                <a href="" id="dl_firm" name="dl_firm"><img src='/bulcky/main/libs/img/box_icon.png' alt='' title="<?php echo __('DL_CULTIBOX_FIRM'); ?>"></a>
            </td>
            <td class="icon_menu2">
                <img src='/bulcky/main/libs/img/versions.png' id="version_soft" alt='' title="">
                <input id="upgradeupload" type="file" name="files[]" style="display:none">
            </td>
            <td class="icon_menu2">
                <a href="" name="restart_rpi" id="restart_rpi"><img src='/bulcky/main/libs/img/rpi_restart.png' alt='' title="<?php echo __('RPI_RESTART'); ?>" /></a>
            </td>
            <td class="icon_menu2">
                <a href="" name="update_rpi" id="update_rpi"><img src='/bulcky/main/libs/img/update_rpi.png' alt='' title="<?php echo __('TOOLTIP_UPDATE_RPI'); ?>" /></a>
            </td>
            <td></td>
        </tr>
    </table>

    <br />
    <hr class="hr_cultipi" />
    <br />
    <br />
    <p class="title_conf"><?php echo __('MGT_ACCESS'); ?></p>
    <br />
    <table class="table_width">
        <tr>
            <td class="conf-marge-cultipi"></td>
            <td class="conf-field-service"><?php echo __('CHANGE_PASSWORD'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_CHANGE_PWD'); ?>" /></td>
            <td><button id="change_password" name="change_password"><?php echo __('NEW_PASSWORD'); ?></button>
            </td>
            <td></td>
        </tr>
    </table>
</div>

<div id="dialog_view_logs" style="display:none">
    <?php echo __('CULTIPI_VIEW_LOGS_TITLE'); ?>:
    <ul class="list_class">
        <li><a class="note_link" href="" id="logs_httpd" name="cultipi_logs"><?php echo __('CULTIPI_LOGS_HTTPD'); ?></a></li>
        <li><a class="note_link" href="" id="logs_mysql" name="cultipi_logs"><?php echo __('CULTIPI_LOGS_MYSQL'); ?></a></li>
        <li><a class="note_link" href="" id="logs_service" name="cultipi_logs"><?php echo __('CULTIPI_LOGS_SERVICE'); ?></a></li>
        <li><a class="note_link" href="" id="logs_cultipi" name="cultipi_logs"><?php echo __('CULTIPI_LOGS_CULTIPI'); ?></a></li>
        <li><a class="note_link" href="" id="logs_system" name="cultipi_logs"><?php echo __('CULTIPI_LOGS_SYSTEM'); ?></a></li>
    </ul>
</div>


<div id="dialog_dl_logs" style="display:none">
    <?php echo __('CULTIPI_DL_LOGS_TITLE'); ?>:
    <ul class="list_class">
        <li><a class="note_link" href="" id="dl_logs_httpd" name="dl_cultipi_logs"><?php echo __('CULTIPI_LOGS_HTTPD'); ?></a></li>
        <li><a class="note_link" href="" id="dl_logs_mysql" name="dl_cultipi_logs"><?php echo __('CULTIPI_LOGS_MYSQL'); ?></a></li>
        <li><a class="note_link" href="" id="dl_logs_service" name="dl_cultipi_logs"><?php echo __('CULTIPI_LOGS_SERVICE'); ?></a></li>
        <li><a class="note_link" href="" id="dl_logs_cultipi" name="dl_cultipi_logs"><?php echo __('CULTIPI_LOGS_CULTIPI'); ?></a></li>
        <li><a class="note_link" href="" id="dl_logs_system" name="dl_cultipi_logs"><?php echo __('CULTIPI_LOGS_SYSTEM'); ?></a></li>
    </ul>
</div>

<div id="confirm_upgrade" style="display:none" title="<?php echo __('UPDATE_CONFIGURATION'); ?>">
    <br /><br />
    <table class="table_width">
        <tr>
            <td class="conf-marge-cultipi"></td>
            <td><?php echo __('ENABLE_REPO_DEV'); ?>:<img src="main/libs/img/infos.png" alt="" title="<?php echo __('TOOLTIP_ENABLE_BETA'); ?>" /></td>
            <td><input type="checkbox" name="beta_upgrade" id="beta_upgrade" <?php if($beta) echo 'checked'; ?> /></td>
            <td class="conf-marge-cultipi"></td>
        </tr>
    </table>
</div>


<div id="dialog_logs_cultipi" style="display:none">
    <div id="div_title_output"><p class="p_center info_logs"><?php echo __('OUTPUT_LOGS'); ?>:</p></div>
    <div id="output_logs"></div>

    <div id="div_title_error"><p class="p_center error_logs"><?php echo __('ERROR_LOGS'); ?>:</p></div>
    <div id="error_logs"></div>
</div>


<div id="error_save_password" title="" style="display:none">
    <p><?php echo __('ERROR_SAVE_PASSWORD'); ?></p>
</div>

<div id="success_save_password" title="" style="display:none">
    <p><?php echo __('SAVED_PASSWORD'); ?></p>
</div>

<div id="confirm_restart_rpi" title="<?php echo __('CONFIRM_RESTART_RPI_TITLE'); ?>" style="display:none">
    <?php echo __('CONFIRM_RESTART_RPI'); ?>
</div>

<div id="confirm_restart_http" title="<?php echo __('CONFIRM_RESTART_HTTP_TITLE'); ?>" style="display:none">
    <?php echo __('CONFIRM_RESTART_HTTP'); ?>
</div>

<div id="network_available" title="" style="display:none">
    <?php echo __('NETWORK_AVAILABLE'); ?>
</div>

<div id="confirm_reset_network" title="" style="display:none">
    <?php echo __('CONFIRM_RESET_NETWORK'); ?>
</div>

<div id="success_restart_http" title="" style="display:none">
    <?php echo __('SUCCESS_RESTART_HTTP'); ?>
</div>

<div id="error_restart_http" title="" style="display:none">
    <?php echo __('ERROR_RESTART_HTTP'); ?>
</div>

<div id="success_restart_rpi" title="" style="display:none">
    <?php echo __('SUCCESS_RESTART_RPI'); ?>
</div>

<div id="dialog_change_password" title="<?php echo __('NEW_PASSWORD'); ?>" style="display:none">
    <form>
        <table class="table_width"> 
            <tr>
                <td class="conf-marge"></td>
                <td class="password-title"><?php echo __('NEW_PASSWORD'); ?>:</td>
                <td class="password-field"><input type="password" id="new_password" /></td>
                <td><div id="error_same_password" class="error_field" style="display:none"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_SAME_PASSWORD'); ?></div><div id="error_empty_password" class="error_field" style="display:none"><img src='/bulcky/main/libs/img/arrow_error.png' alt=''><?php echo __('ERROR_EMPTY_PASSWORD'); ?></div></td>
            </tr>
            <tr>
                <td></td>
                <td><?php echo __('CONFIRM_NEW_PASSWORD'); ?>:</td>
                <td><input type="password" id="confirm_new_password" /></td>
                <td></td>
            </tr>
        </table>
        <p class="p_center"><input type="submit" id="save_password" value="<?php echo __('SAVE_PASSWORD'); ?>"></p>
    </form>
</div>


<div id="empty_network_conf" style="display:none">
    <p><?php echo __('EMPTY_NETWORK_CONFIG'); ?></p>
</div>

<div id="error_network_file" style="display:none">
    <p><?php echo __('ERROR_NET_FILE_CREATION'); ?></p>
</div>

<div id="network_new_addr_set" style="display:none">
    <?php echo __('AVAILABLE_MODULE_SET'); ?>: <p class='p_center'><a class='note_link' href='http://<?php echo $hostname; ?>/bulcky/' target='_blank'>http://<?php echo $hostname; ?>/bulcky/</a></p>
</div>

<div id="error_restore_conf" style="display:none">
    <p><?php echo __('RESTORED_CONF'); ?></p>
</div>

<div id="cultipi_no_update" style="display:none">
    <p><?php echo __('CULTIPI_NO_UPDATE'); ?></p>
</div>

<div id="cultipi_access_update" style="display:none">
    <p><?php echo __('CULTIPI_ACCESS_UPDATE'); ?></p>
</div>


<div id="cultipi_confirm_update" style="display:none">
    <p><?php echo __('CULTIPI_CONFIRM_UPDATE'); ?></p>
</div>


<div id="cultipi_updated" style="display:none">
    <p><?php echo __('CULTIPI_UPDATED'); ?></p>
</div>


<div id="wifi_essid_list" style="display:none" title="<?php echo __('WIFI_ESSID_SCAN_TITLE'); ?>">
</div>


<div id="progress_conf">
    <div id="progress_bar_conf" class="bar" style="width: 0%;"></div>
    <p class="p_center" id="progress_purcent"></p>
</div>

<div id="success_manual_upgrade" title="<?php echo __('MANUAL_UPGRADE'); ?>" style="display:none">
    <p><?php echo __('SUCCESS_MANUAL_UPGRADE'); ?></p>
</div>


<div id="error_manual_upgrade" title="<?php echo __('MANUAL_UPGRADE'); ?>" style="display:none">
    <p><?php echo __('ERROR_MANUAL_UPGRADE'); ?></p>
</div>

<div id="progress_up">
    <div id="progress_bar_up" class="bar" style="width: 0%;"></div>
    <p class="p_center" id="progress_purcent_up"></p>
</div>

<div id="mail_config_div" title="<?php echo __('MAIL'); ?>" style="display:none">
    <?php
        // Read list of providers
        $providerArr = configuration\getEmailProvider();
        // Read user information from database
        $emailUserConf = configuration\getEmailUserConf();
    ?>
    <table class="table_width">
        <tr>
            <td class="conf-marge"></td>
            <td class="conf-title"><label class="subsub_title">Fournisseur mail :</label></td>
            <td>
                <select name="" id="EMAIL_PROVIDER">
                    <?php
                        // Add an option for each provider
                        foreach ($providerArr as $providerInfos)
                        {
                            $selected = "";
                            if($providerInfos['smtp'] == $emailUserConf['EMAIL_SMTP'])
                                $selected = "selected";

                            echo '<option value="' . $providerInfos['smtp'] . '" ' . $selected . ' > ' . $providerInfos['name'] . ' </option>';
                        }
                    ?>
                </select>
            </td>
        </tr>
        <tr>
            <td class="conf-marge"></td>
            <td class="conf-title"><label class="subsub_title">Serveur smtp :</label></td>
            <td>
                <?php
                    $disabled = 'disabled = "disabled"';
                    if ($providerInfos['smtp'] == "other")
                        $disabled = "";
                    echo '<input  type="text" size="40" id="EMAIL_SMTP" value="' . $emailUserConf['EMAIL_SMTP'] . '" ' . $disabled . '/>';
                ?>
            </td>
        </tr>
        <tr>
            <td class="conf-marge"></td>
            <td class="conf-title"><label class="subsub_title">Port :</label></td>
            <td>
                <input  type="text" size="5" id="EMAIL_PORT" value="<?php echo $emailUserConf['EMAIL_PORT']; ?>" />
            </td>
        </tr>
        <tr>
            <td class="conf-marge"></td>
            <td class="conf-title"><label class="subsub_title">Adresse email :</label></td>
            <td>
                <input  type="text" size="40" id="EMAIL_ADRESS" value="<?php echo $emailUserConf['EMAIL_ADRESS']; ?>" />
            </td>
        </tr>
        <tr>
            <td class="conf-marge"></td>
            <td class="conf-title"><label class="subsub_title">Mot de passe :</label></td>
            <td>
                <input  type="password" size="40" id="EMAIL_PASSWORD" value="" />
            </td>
        </tr>
        <tr>
             <?php
                $en = "";
                if (strcmp($emailUserConf['EMAIL_USE_SSL'],"true") == 0)
                    $en = "checked";
             ?>
            <td class="conf-marge"></td>
            <td class="conf-title"><label class="subsub_title">Utilisation SSL :</label></td>
            <td>Activée : <input type="checkbox" id="EMAIL_USE_SSL" value="true" <?php echo $en;?>></td>
        </tr>
    </table>
</div>

<div id="success_save_mail" title="" style="display:none">
    <p><?php echo __('SUCCESS_SAVE_MAIL'); ?></p>
</div>

<div id="test_send_mail" title="" style="display:none">
    <p><?php echo __('TEST_SEND_MAIL'); ?></p>
    <p id="test_send_mail_return" ></p>
</div>

<div id="supervision_config_div" title="<?php echo __('CONF_SUPERVISION'); ?>" style="display:none">
    <table class="table_width" id="supervision_config_table">
        <?php
            // Retrieve information about supervision 
            $supervisionElements = array();
            $supervisionElements = bulcky\getSupervisionUserConf();
            
            // Load XML events
            // List process already defined
            $dir    = $GLOBALS['CULTIPI_CONF_TEMP_PATH'] . '/' .  'serverSupervision' . '/';
            $files  = array_diff(scandir($dir), array('..', '.', 'conf.xml'));
            sort($files,SORT_STRING);
            $processID  = 0;

            foreach ($files as $file)
            {
                // Load XML contents
                $xml = simplexml_load_file($dir . $file);
                
                // Get id of process 
                $fileBase = explode( ".", $file )[0];
                $processID  = explode( "_", $fileBase )[1];

                // Retrieve action of this process 
                $action = $xml->xpath('/conf/item[@name="action"]')[0]["value"];
                
                switch ($action) 
                {
                    case "checkPing" :
                        
                        ?>
                        <tr id="<?php echo $file ;?>">
                            <td><label><?php echo $processID ;?> : Vérification ping :</label></td>
                            <td><input type="image" id="button_supervision_configure_<?php echo $file ;?>"
                                data-filename="<?php echo $file ;?>"
                                data-supervisiontype="<?php echo $action ;?>"
                                data-processid="<?php echo $processID ;?>"
                                name="button_supervision_configure"
                                title="Configurer"
                                src="main/libs/img/advancedsettings.png" 
                                alt="Configurer"
                            /></td>
                            <td><input type="image" id="button_supervision_remove_<?php echo $file ;?>"
                                data-filename="<?php echo $file ;?>"
                                name="button_supervision_remove"
                                title="Supprimer"
                                src="main/libs/img/button_cancel.png" 
                                alt="Supprimer"
                            /></td>
                        </tr>
                        <?php
                        break;
                    case "checkSensor" :
                        $sensor = $xml->xpath('/conf/item[@name="sensor"]')[0]["value"];
                        ?>
                        <tr id="<?php echo $file ;?>">
                            <td><label><?php echo $processID ;?> : Vérification Capteur n°<?php echo $sensor; ?> :</label></td>
                            <td><input type="image" id="button_supervision_configure_<?php echo $file ;?>"
                                data-filename="<?php echo $file ;?>"
                                data-supervisiontype="<?php echo $action ;?>"
                                data-processid="<?php echo $processID ;?>"
                                name="button_supervision_configure"
                                title="Configurer"
                                src="main/libs/img/advancedsettings.png" 
                                alt="Configurer"
                            /></td>
                            <td><input type="image" id="button_supervision_remove_<?php echo $file ;?>"
                                data-filename="<?php echo $file ;?>"
                                name="button_supervision_remove"
                                title="Supprimer"
                                src="main/libs/img/button_cancel.png" 
                                alt="Supprimer"
                            /></td>
                        </tr>
                        <?php
                        break;
                    case "report" :
                        ?>
                        <tr id="<?php echo $file ;?>">
                            <td><label><?php echo $processID ;?> : Rapport journalier :</label></td>
                            <td><input type="image" id="button_supervision_configure_<?php echo $file ;?>"
                                data-filename="<?php echo $file ;?>"
                                data-supervisiontype="<?php echo $action ;?>"
                                data-processid="<?php echo $processID ;?>"
                                name="button_supervision_configure"
                                title="Configurer"
                                src="main/libs/img/advancedsettings.png" 
                                alt="Configurer"
                            /></td>
                            <td><input type="image" id="button_supervision_remove_<?php echo $file ;?>"
                                data-filename="<?php echo $file ;?>"
                                name="button_supervision_remove"
                                title="Supprimer"
                                src="main/libs/img/button_cancel.png" 
                                alt="Supprimer"
                            /></td>
                        </tr>
                        <?php
                        break;
                }
            }
            ?>
            <tr id="button_supervision_row_add_type" >
                <td>
                    <select id="button_supervision_add_type">
                        <option value="checkPing" > Check Ping </option>
                        <option value="checkSensor" > Check Sensor </option>
                        <option value="report" > Rapport </option>
                    </select>
                </td>
                <td><input type="image" id="button_supervision_add"
                    name="button_supervision_add"
                    data-nextprocess="<?php echo $processID + 1 ;?>"
                    title="Ajout supervision"
                    src="main/libs/img/add.png" 
                    alt="Ajout supervision"
                /></td>
            </tr>
    </table>
</div>

<div id="supervision_edit_checkSensor" title="" style="display:none">
    <table>
        <tr>
            <td>Capteur : </td>
            <td><input  type="text" size="5" id="supervision_edit_checkSensor_sensor" value="" /></td>
        </tr>
        <tr>
            <td>Nom du capteur : </td>
            <td><input  type="text" size="10" id="supervision_edit_checkSensor_sensorname" value="" /></td>
        </tr>
        <tr>
            <td>Sortie capteur : </td>
            <td>
                <select id="supervision_edit_checkSensor_sensorOutput">
                    <option value="1" > 1 </option>
                    <option value="2" > 2 </option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Seuil : </td>
            <td><input  type="text" size="5" id="supervision_edit_checkSensor_valueseuil" value="" /></td>
        </tr>
        <tr>
            <td>Déclenchement si valeur : </td>
            <td><select id="supervision_edit_checkSensor_alertif">
                    <option value="up"> Supérieure </option>
                    <option value="down"> Inférieure </option>
                </select></td>
            <td>au seuil </td>
        </tr>
        <tr>
            <td>Temps avant déclenchement : </td>
            <td><input  type="text" size="5" id="supervision_edit_checkSensor_timeseuilins" value="" /></td>
        </tr>
        <tr>
            <td>Adresse eMail : </td>
            <td  colspan="2" ><input  type="text" size="40" id="supervision_edit_checkSensor_email" value="" /></td>
        </tr>
    </table>
</div>

<div id="supervision_edit_checkPing" title="" style="display:none">
    <table>
        <tr>
            <td>Adresse ip 1 : </td>
            <td><input  type="text" size="40" id="supervision_edit_checkPing_ip_0" value="" /></td>
        </tr>
        <tr>
            <td>Adresse ip 2 : </td>
            <td><input  type="text" size="40" id="supervision_edit_checkPing_ip_1" value="" /></td>
        </tr>
        <tr>
            <td>Adresse ip 3 : </td>
            <td><input  type="text" size="40" id="supervision_edit_checkPing_ip_2" value="" /></td>
        </tr>
        <tr>
            <td>Adresse ip 4 : </td>
            <td><input  type="text" size="40" id="supervision_edit_checkPing_ip_3" value="" /></td>
        </tr>
        <tr>
            <td>Adresse ip 5 : </td>
            <td><input  type="text" size="40" id="supervision_edit_checkPing_ip_4" value="" /></td>
        </tr>
        <tr>
            <td >Temps avant déclenchement : </td>
            <td><input  type="text" size="5" id="supervision_edit_checkPing_timemax" value="" /></td>
        </tr>
        <tr>
            <td>Adresse eMail : </td>
            <td><input  type="text" size="40" id="supervision_edit_checkPing_email" value="" /></td>
        </tr>
    </table>
</div>

<div id="supervision_edit_report" title="" style="display:none">
    <table>
        <tr>
            <td>Adresse eMail : </td>
            <td><input  type="text" size="40" id="supervision_edit_report_email" value="" /></td>
        </tr>
        <tr>
            <td><select id="supervision_edit_report_frequency">
                    <option value="daily"> journalier </option>
                    <option value="monthly"> mensuel </option>
                </select></td>
        </tr>
        <tr>
            <td>Heure : </td>
            <td><input  type="text" size="40" id="supervision_edit_report_hour" value="18" /></td>
        </tr>
    </table>
</div>


<div id="success_save_supervision" title="" style="display:none">
    <p><?php echo __('SUCCESS_SAVE_SUPERVISION'); ?></p>
</div>


<div id="dl_firm_div" style="display:none" title="<?php echo __('DL_CULTIBOX_FIRM'); ?>">
    <br />
    <?php echo __('DL_FIRM_WIFI'); ?>
    <p class="p_center"><button id="dl_wifi_firm"><?php echo __('DL_BUTTON_CULTIBOX'); ?> </button></p>

    <br />
    <?php echo __('DL_FIRM_CULTIBOX'); ?> 
    <p class="p_center"><button id="dl_cultibox_firm"><?php echo __('DL_BUTTON_CULTIBOX'); ?> </button></p>
</div>


<div id="wifi_upgrade" style="display:none" title="<?php echo __('WIFI_UPGRADE_TITLE'); ?>">
    <?php echo __('TOOLTIP_WIFI_UPGRADE'); ?>
</div>

<script>expand("<?php echo $submenu; ?>");</script>


